<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Al-Qur'an Bertajwid & Terjemahan Melayu â€” by Zulkifli.MNA</title>
  <meta name="description" content="Laman Al-Qur'an bertajwid berwarna dan terjemahan Melayu. Baca, dengar dan pelajari tajwid dengan panduan warna dan keterangan ringkas." />
  <style>
    :root{
      --bg:#eaf6ef; /* daun muda lembut */
      --primary:#055e46;
      --card:#ffffff;
      --muted:#6b6b6b;
      --accent:#004d40;
      --maxw:980px;
    }
    html,body{height:100%;margin:0;font-family:Arial, "Noto Naskh Arabic", serif;background:var(--bg);color:#222}
    .wrap{max-width:var(--maxw);margin:0 auto;padding:18px}
    header{background:var(--primary);color:#fff;padding:18px;border-radius:8px 8px 0 0;text-align:center}
    header h1{margin:0;font-size:22px}
    header p{margin:6px 0 0 0;font-size:14px;opacity:.95}
    .byline{font-size:13px;margin-top:6px;opacity:.9}
    .card{background:var(--card);padding:14px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.06);margin-top:14px}
    select#surah{width:100%;padding:10px;border-radius:8px;border:1px solid #cfcfcf;font-size:16px}
    #loading{color:var(--muted);padding:12px;text-align:center}
    .ayah{background:#fff;margin:10px 0;padding:12px;border-radius:8px;border:1px solid #e6efe9}
    .arabic{direction:rtl;font-size:30px;line-height:2;text-align:right;font-family:"Noto Naskh Arabic", "Scheherazade", serif}
    .translation{font-size:17px;color:#333;margin-top:8px}
    .controls{display:flex;gap:8px;align-items:center;margin-top:10px;flex-wrap:wrap}
    button.play{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:6px;cursor:pointer}
    .tajwid-guide table{width:100%;border-collapse:collapse;margin-top:12px}
    .tajwid-guide th,.tajwid-guide td{padding:8px;border-bottom:1px solid #e6efe9;text-align:left}
    .tajwid-guide td.color{width:120px;font-weight:600}
    footer{margin-top:18px;padding:12px;background:#e2f3ea;border-radius:8px;color:#083a2f}
    .intro p{margin:8px 0}
    .badge{display:inline-block;padding:4px 8px;background:#fff;border-radius:16px;margin-left:8px;font-size:12px;color:var(--primary)}
    /* tajwid classes - warna */
    .tj-madd{color:#008000;font-weight:600}
    .tj-idgham{color:#ff6600;font-weight:600}
    .tj-ikhfa{color:#cc00ff;font-weight:600}
    .tj-qalqalah{color:#0000cc;font-weight:600}
    .tj-ghunnah{color:#ff0000;font-weight:600}
    .tj-ikhfa-shafawi{color:#990099;font-weight:600}
    .tj-iqlab{color:#ff9900;font-weight:600}
    .tj-idhar{color:#0099cc;font-weight:600}
    .note{font-size:13px;color:var(--muted)}
    .hadith{background:#fff8e6;padding:10px;border-radius:6px;border:1px solid #f1e0b8;margin-top:10px}
    .dua{background:#f0fff8;padding:10px;border-radius:6px;border:1px solid #d6f2e0;margin-top:10px}
    .by{font-size:12px;color:#666;margin-top:6px}
    .small{font-size:13px}
    /* responsive */
    @media (max-width:520px){
      .arabic{font-size:26px}
      header h1{font-size:18px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ğŸ“– Al-Qur'an Bertajwid & Terjemahan Melayu</h1>
      <div class="byline">Interaktif â€¢ Tajwid berwarna â€¢ Audio (jika tersedia) <span class="badge">by Zulkifli.MNA</span></div>
    </header>

    <div class="card intro">
      <h3>Pengenalan singkat</h3>
      <p>Selamat datang ke laman pembelajaran Al-Qur'an ini. Laman ini direka untuk membantu bacaan Anda dengan panduan warna tajwid, terjemahan Bahasa Melayu, serta audio bacaan apabila tersedia.</p>

      <div class="hadith">
        <strong>Hadis ringkas (petikan sahih):</strong>
        <p>â€œØ®ÙÙŠÙ’Ø±ÙÙƒÙÙ…Ù’ Ù…ÙÙ†Ù’ ØªÙØ¹ÙÙ„Ù‘ÙÙ…Ù Ø§Ù„Ù’Ù‚ÙØ±Ù’Ø¢Ù†Ù ÙˆÙØ¹ÙÙ„Ù‘ÙÙ…ÙÙ‡Ùâ€ â€” <em>â€œSebaik-baik kamu ialah orang yang belajar Al-Qurâ€™an dan mengajarkannya.â€</em> (HR. Al-Bukhari)</p>
      </div>

      <div class="dua">
        <strong>Doa sebelum belajar:</strong>
        <p><em>Ø§Ù„Ù„Ù‡Ù… Ø¹Ù„Ù…Ù†Ø§ Ù…Ø§ ÙŠÙ†ÙØ¹Ù†Ø§ ÙˆØ§Ù†ÙØ¹Ù†Ø§ Ø¨Ù…Ø§ Ø¹Ù„Ù…ØªÙ†Ø§ ÙˆØ²Ø¯Ù†Ø§ Ø¹Ù„Ù…Ø§Ù‹</em></p>
        <p class="by">Terjemah: "Ya Allah, ajarkanlah kami apa yang memberi manfaat, berilah manfaat kepada kami dari apa yang Engkau ajarkan, dan tambahkanlah ilmu kepada kami."</p>
      </div>
    </div>

    <div class="card">
      <label for="surah"><strong>Pilih Surah (1â€“114)</strong></label>
      <select id="surah"></select>
      <div id="loading">Memuatkan senarai surah...</div>
      <div id="controls" class="controls" style="display:none">
        <button id="playSurah" class="play">â–¶ï¸ Mainkan audio surah</button>
        <div class="note">Jika audio tidak muncul bermakna sumber audio tidak tersedia untuk surah ini.</div>
      </div>
      <div id="quran"></div>
    </div>

    <div class="card tajwid-guide">
      <h3>ğŸ¨ Panduan Warna Hukum Tajwid</h3>
      <table>
        <tr><th>Warna</th><th>Hukum</th><th>Keterangan</th></tr>
        <tr><td class="color"><span class="tj-madd">Hijau</span></td><td>Mad</td><td>Panjangkan bacaan 2â€“6 harakat</td></tr>
        <tr><td class="color"><span class="tj-idgham">Oren</span></td><td>Idgham</td><td>Lebur bunyi huruf bila bertemu huruf tertentu</td></tr>
        <tr><td class="color"><span class="tj-ikhfa">Ungu</span></td><td>Ikhfa'</td><td>Sembunyi bacaan dengan dengung halus</td></tr>
        <tr><td class="color"><span class="tj-qalqalah">Biru</span></td><td>Qalqalah</td><td>Pantulan bunyi huruf qalqalah</td></tr>
        <tr><td class="color"><span class="tj-ghunnah">Merah</span></td><td>Ghunnah</td><td>Dengung kuat (contoh: 2 harakat)</td></tr>
        <tr><td class="color"><span class="tj-ikhfa-shafawi">Ungu Gelap</span></td><td>Ikhfa' Syafawi</td><td>Ù… bertemu Ø¨ â€” dengung khas</td></tr>
        <tr><td class="color"><span class="tj-iqlab">Kuning</span></td><td>Iqlab</td><td>Øªukar bunyi Ù† ke Ù… (contoh: sebelum Ø¨)</td></tr>
        <tr><td class="color"><span class="tj-idhar">Biru Muda</span></td><td>Idhar</td><td>Bacaan jelas tanpa dengung</td></tr>
      </table>
      <div class="small note">Nota: Jika API pembekal teks menyediakan markup tajwid (contoh span class), laman ini akan memaparkan warna tajwid tersebut. Jika tidak, akan dipaparkan teks arab biasa dan terjemahan.</div>
    </div>

    <footer>
      <div>Data Arab & Tajwid diperoleh daripada API awam bila tersedia; terjemahan Melayu oleh sumber awam. Gunakan laman ini untuk tujuan pembelajaran dan dakwah.</div>
    </footer>
  </div>

  <script>
    // -----------------------
    // NOTE: This page uses public APIs.
    // API availability and shapes may vary. The script tries multiple fallbacks.
    // -----------------------

    const surahSelect = document.getElementById('surah');
    const quranDiv = document.getElementById('quran');
    const loading = document.getElementById('loading');
    const controls = document.getElementById('controls');
    const playSurah = document.getElementById('playSurah');
    let currentAudio = null;

    // populate surah list with nice labels (surah names will be fetched)
    for(let i=1;i<=114;i++){
      const opt = document.createElement('option');
      opt.value = i;
      opt.textContent = `Surah ${i}`;
      surahSelect.appendChild(opt);
    }

    // helper: try multiple fetch shapes safely
    async function tryFetch(url){
      try {
        const r = await fetch(url);
        if(!r.ok) throw new Error('HTTP '+r.status);
        return await r.json();
      } catch(e){
        return null;
      }
    }

    // Useful endpoints (the code will attempt these):
    // 1) api.alquran.cloud (commonly available) - for Arabic text and audio: /v1/surah/{n}
    //    e.g. https://api.alquran.cloud/v1/surah/1/ar.alafasy  (audio edition)
    // 2) Another tajwid API (if available) will be attempted (this is optional)
    function endpointAlquranSurah(surah, edition){
      // edition examples: 'ar.alafasy', 'quran-uthmani', 'en.asad'
      return `https://api.alquran.cloud/v1/surah/${surah}/${edition}`;
    }

    // Some other APIs (could be down) - we attempt a generic tajwid API (if you have API key you can replace)
    function endpointTajwid(surah){
      // placeholder for possible tajwid provider; left as trial - many public tajwid endpoints vary
      return `https://api.alif.my.id/alquran/${surah}/tajwid`; // if available
    }

    // load surah function:
    async function loadSurah(n){
      quranDiv.innerHTML = '';
      loading.style.display = 'block';
      loading.textContent = 'Memuatkan surah...';
      controls.style.display = 'none';
      currentAudio = null;

      // Try 1: fetch Arabic + translation using alquran.cloud surah (with multiple editions)
      // prefer: quran-uthmani for Arabic text; en.asad or en.trans for English â€” for Malay we'll try separate endpoint
      const rArabic = await tryFetch(endpointAlquranSurah(n,'quran-uthmani'));
      const rAudio = await tryFetch(endpointAlquranSurah(n,'ar.alafasy')); // often returns audio info in edition
      const rEn = await tryFetch(endpointAlquranSurah(n,'en.asad')); // english fallback
      // For Malay translation: try an open Malay translation endpoint (not guaranteed)
      // I will attempt 'ms.fathimah' (if exists) or fallback to english:
      const rMs = await tryFetch(endpointAlquranSurah(n,'ms.fathimah')) || await tryFetch(endpointAlquranSurah(n,'ms.suara'));

      // Try tandas for tajwid (special API)
      const rTajwid = await tryFetch(endpointTajwid(n));

      // choose arabic source
      const arabData = rArabic && rArabic.data ? rArabic.data : (rAudio && rAudio.data ? rAudio.data : null);
      // translation
      const transData = rMs && rMs.data ? rMs.data : (rEn && rEn.data ? rEn.data : null);

      // audio determination (try to build audio url or use alafasy edition which includes audio links per ayah)
      // Many alquran.cloud responses include data.recitation or ayahs[].audio
      if(rAudio && rAudio.data && rAudio.data.ayahs){
        // try to get first ayah audio as sample: some apis provide full file too
        const first = rAudio.data.ayahs[0];
        if(first && (first.audio || first.audioSecondary)){
          currentAudio = first.audio || (first.audioSecondary && first.audioSecondary[0]) || null;
        }
      }
      // fallback: try known cdn (may fail)
      if(!currentAudio){
        // do not assign if unknown; keep null
      }

      // If arabic data present, show ayahs
      if(arabData && arabData.ayahs && arabData.ayahs.length){
        loading.style.display = 'none';
        const ayahs = arabData.ayahs;
        ayahs.forEach((ayahObj, i) => {
          const ayahDiv = document.createElement('div');
          ayahDiv.className = 'ayah';

          // Arabic: prefer ayahObj.text (often Uthmani) or fallback
          let arabic = ayahObj.text || ayahObj.ar || ayahObj.arabic || '';
          // If tajwid API is present and returns HTML markup, prefer that
          if(rTajwid && rTajwid.data && rTajwid.data.ayahs && rTajwid.data.ayahs[i] && rTajwid.data.ayahs[i].text){
            arabic = rTajwid.data.ayahs[i].text;
          }

          const arabicEl = document.createElement('div');
          arabicEl.className = 'arabic';
          // if the text contains tags (e.g. span classes for tajwid) insert as HTML (safe-ish)
          if(arabic.includes('<')){
            arabicEl.innerHTML = arabic;
          } else {
            arabicEl.textContent = arabic;
          }

          // translation - try to match by index
          let tranText = '';
          if(transData && transData.ayahs && transData.ayahs[i]){
            // Some translations store '.text' or '.translation'
            tranText = transData.ayahs[i].text || transData.ayahs[i].translation || transData.ayahs[i].translation_text || '';
          } else if(transData && transData.ayahs && transData.ayahs[i] && transData.ayahs[i].translations){
            tranText = transData.ayahs[i].translations[0].text || '';
          }

          const transEl = document.createElement('div');
          transEl.className = 'translation';
          transEl.textContent = tranText;

          ayahDiv.appendChild(arabicEl);
          if(tranText) ayahDiv.appendChild(transEl);
          quranDiv.appendChild(ayahDiv);
        });
      } else {
        loading.textContent = 'âš ï¸ Gagal memuatkan ayat. Sila cuba lagi (API mungkin tidak memberi data tajwid/ayat sekarang).';
      }

      // audio control
      if(currentAudio){
        controls.style.display = 'flex';
        playSurah.onclick = () => {
          try{
            new Audio(currentAudio).play();
          }catch(e){
            alert('Audio tidak boleh dimainkan: '+(e.message||e));
          }
        };
      } else {
        controls.style.display = 'none';
      }
    }

    // initial
    surahSelect.value = 1;
    loadSurah(1);

    surahSelect.addEventListener('change', e => loadSurah(e.target.value));
  </script>
</body>
</html>